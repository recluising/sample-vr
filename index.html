<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Hello, WebVR! • A-Frame</title>
    <meta name="description" content="Hello, WebVR! • A-Frame">
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script>

      var initialRun = true;
      const info = document.getElementById('info');
      if(navigator.getVRDisplays && navigator.getGamepads) {
        info.textContent = 'WebVR API and Gamepad API supported.'
        reportDisplays();
      } else {
        info.textContent = 'WebVR API and/or Gamepad API not supported by this browser.'
      }

      function reportDisplays() {
  navigator.getVRDisplays().then(function(displays) {
      console.log(displays.length + ' displays');
    for(var i = 0; i < displays.length; i++) {
      var cap = displays[i].capabilities;
      // cap is a VRDisplayCapabilities object
      var listItem = document.createElement('li');
      listItem.innerHTML = '<strong>Display ' + (i+1) + '</strong>'
                   + '<br>VR Display ID: ' + displays[i].displayId
                   + '<br>VR Display Name: ' + displays[i].displayName
                   + '<br>Display can present content: ' + cap.canPresent
                   + '<br>Display is separate from the computer\'s main display: ' + cap.hasExternalDisplay
                   + '<br>Display can return position info: ' + cap.hasPosition
                   + '<br>Display can return orientation info: ' + cap.hasOrientation
                   + '<br>Display max layers: ' + cap.maxLayers;
      list.appendChild(listItem);
    }
    function reportGamepads() {
    var gamepads = navigator.getGamepads();
    console.log(gamepads.length + ' controllers');
    for(var i = 0; i < gamepads.length; ++i) {
        var gp = gamepads[i];
        var listItem = document.createElement('li');
        listItem.classList = 'gamepad';
        listItem.innerHTML = '<strong>Gamepad ' + gp.index + '</strong> (' + gp.id + ')'
                 + '<br>Associated with VR Display ID: ' + gp.displayId
                 + '<br>Gamepad associated with which hand: ' + gp.hand
                 + '<br>Available haptic actuators: ' + gp.hapticActuators.length
                 + '<br>Gamepad can return position info: ' + gp.pose.hasPosition
                 + '<br>Gamepad can return orientation info: ' + gp.pose.hasOrientation;
        list.appendChild(listItem);
    }
    initialRun = false;
}

    setTimeout(reportGamepads, 1000);
    // For VR, controllers will only be active after their corresponding headset is active
  });

      AFRAME.registerComponent('input-listen', {
        init:
            function () {
              let interval;
              //Grip Pressed
              this.el.addEventListener('xbuttondown', function (e) {
                interval = setInterval(()=>{
                  const sphere = document.querySelector('#sphere');
                  sphere.object3D.position.set(sphere.object3D.position.x + 1,sphere.object3D.position.y,sphere.object3D.position.z )
                },500)
              });
              //Grip Released
              this.el.addEventListener('xbuttonup', function (e) {
                  //Setting grip flag as false.
                  this.grip = false;
                  clearInterval(interval)
              });
              
            }
      })
      
    </script>
  </head>
  <body>
    <div id="info"></div>
    <a-scene background="color: #FAFAFA">
      <a-sphere id="sphere" position="0 1.25 -5" radius="1.25" color="#EF2D5E" shadow></a-sphere>
      <a-entity oculus-touch-controls="hand: left"></a-entity>
<a-entity oculus-touch-controls="hand: right"></a-entity>
    </a-scene>
  </body>

  
</html>